# ü§ñ AI Agent Marketplace Simulation

> **A real-time, multi-agent economic simulation where 12 distinct AI personalities trade, negotiate, and shaping market dynamics.**

![CI Status](https://github.com/YOUR_USERNAME/agent-market/workflows/CI%20Pipeline/badge.svg)
![Coverage](https://img.shields.io/badge/coverage-72%25-yellow)
![Python](https://img.shields.io/badge/python-3.10%2B-blue)

![Simulation Dashboard](https://github.com/user-attachments/assets/placeholder)

## üèÜ Overview

This project simulates a **livestock market** (or any asset class) populated by autonomous AI agents. Unlike standard simulations, each agent possesses a unique **Persona** (e.g., "The Whale", "The Panic Seller", "The Value Investor") backed by a **Hybrid LLM Strategy**.

- **Strategic Agents** use **Llama 3 70B** (Groq) for deep reasoning.
- **Analytical Agents** use **Gemini 1.5 Flash** for long-context analysis.
- **Algorithmic Agents** use **GPT-4o Mini** for strict rule following.
- **Reactive Agents** use **Llama 3 8B** for high-speed execution.

## ‚ú® Key Features

1.  **Hybrid LLM Engine**: Orchestrates 4 different LLMs simultaneously to balance cost, speed, and intelligence.
2.  **Rich Terminal UI**: Real-time dashboard with Order Book, Ticker, and live "Breaking News" generated by a Journalist Agent.
3.  **Emergent Behavior**: Watch FOMO buyers spark rallies while Contrarians short the top.
4.  **Persistent Memory**: Agents remember past trades using **ChromaDB** (Vector Store) + **SQLite** (Ledger).
5.  **Data Analysis**: Built-in tools to plot price history and wealth distribution.

## üöÄ Quick Start

### Prerequisites
- Python 3.12+
- `uv` (recommended) or `pip`

### Installation

1.  **Clone the repo**
    ```bash
    git clone https://github.com/your-username/agent-market.git
    cd agent-market
    ```

2.  **Install dependencies**
    ```bash
    uv sync
    # OR
    pip install -r requirements.txt
    ```

3.  **Setup Keys**
    Copy `.env.example` to `.env` and add your keys:
    ```bash
    cp .env.example .env
    ```
    *   `GROQ_API_KEY` (Required for most agents)
    *   `GEMINI_API_KEY` (Required for Journalist/Value agents)
    *   `OPENAI_API_KEY` (Optional, falls back if missing)

### Running the Simulation

```bash
uv run python main.py
```
*Press `Ctrl+C` to stop.*

### Demo Guide (Bounded Run)

Run a finite simulation and generate checkpoints for evidence:
```bash
uv run python main.py --max-ticks 200 --checkpoint-every 20
```

### Analyzing Results

After a run, generate charts:
```bash
uv run python src/analysis/chart.py
```
Check the `plots/` directory for `price_history.png`.

### Checkpoints

Checkpoint snapshots (JSON) are written to `checkpoints/` when enabled via `--checkpoint-every`.

### Experiment Evidence

- Logs: `logs/`
- Plots: `plots/`
- Checkpoints: `checkpoints/`

### Running Tests

```bash
uv run pytest tests/ -v
```

**Coverage Report:**
```bash
uv run pytest --cov=src --cov-report=html
open htmlcov/index.html
```

## üìö Documentation

Detailed documentation is available in the project root:

-   **[Technical Docs](TECHNICAL_DOCS.md)**: Hybrid LLM strategy, architecture, and data schemas.
-   **[Agent Rules](AGENTS.md)**: Operational guide for agent workflows and constraints.

## üß† Architecture

The system follows a **Facade-based architecture** where the central `MarketEngine` mediates all interactions between the autonomous **Agents** and the **Order Book**.

### Core Loop
1.  **Sense:** Agents receive the current `MarketState` (Price, L1 Order Book).
2.  **Think:** Agents query their Vector Memory (ChromaDB) for past lessons, then send a prompt to their assigned LLM.
3.  **Act:** Agents submit a structured JSON decision (`BUY`, `SELL`, `HOLD`).
4.  **Execute:** The Market Engine matches orders and persists trades to the Ledger.

## üì¶ Tech Stack
-   **Orchestration**: `python`, `uv`
-   **LLMs**: `litellm` (Unified Interface)
-   **Database**: `sqlite` (Relational), `chromadb` (Vector)
-   **UI**: `rich`
-   **Data**: `pandas`, `seaborn`

## ü§ù Contributing
1.  Fork it.
2.  Create a branch (`git checkout -b feature/cool-agent`).
3.  Commit changes.
4.  Push to branch.
5.  Open a Pull Request.

## üì¶ Deployment

### Terminal UI (Local)
```bash
uv run python main.py
```

### Streamlit Web UI (Optional)
```bash
uv add streamlit plotly
streamlit run app_web.py
```
Add API keys as secrets if deploying via Streamlit Community Cloud.

### Docker
```bash
docker build -t agent-market .
docker run --env-file .env agent-market
```

### Cloud Run (GCP)
```bash
gcloud run deploy agent-market \
  --source . \
  --region us-central1 \
  --allow-unauthenticated
```

### Render / Railway / Fly.io
Set build command to `uv sync` and start command to `uv run python main.py`, then add API keys as environment variables.

---
*Built for the Multi-Agent Marketplace Simulation Challenge.*

## References
- Agent Laboratory: https://agentlaboratory.github.io/
- Generative Agents: https://github.com/joonspk-research/generative_agents
